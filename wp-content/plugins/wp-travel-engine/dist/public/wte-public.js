!function(e){var t={};function a(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=t,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(r,n,function(t){return e[t]}.bind(null,n));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=48)}([,,,,function(e,t){e.exports=function(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,a){var r=a(19),n=a(20),i=a(13),o=a(21);e.exports=function(e){return r(e)||n(e)||i(e)||o()},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=window.regeneratorRuntime},,function(e,t,a){var r=a(15),n=a(16),i=a(13),o=a(17);e.exports=function(e,t){return r(e)||n(e,t)||i(e,t)||o()},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){function a(e,t,a,r,n,i,o){try{var l=e[i](o),s=l.value}catch(e){return void a(e)}l.done?t(s):Promise.resolve(s).then(r,n)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function l(e){a(o,n,i,l,s,"next",e)}function s(e){a(o,n,i,l,s,"throw",e)}l(void 0)}))}},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){function a(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,a){var r=a(10);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?r(e,t):void 0}},e.exports.default=e.exports,e.exports.__esModule=!0},,function(e,t){e.exports=function(e){if(Array.isArray(e))return e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var r,n,i=[],_n=!0,o=!1;try{for(a=a.call(e);!(_n=(r=a.next()).done)&&(i.push(r.value),!t||i.length!==t);_n=!0);}catch(e){o=!0,n=e}finally{try{_n||null==a.return||a.return()}finally{if(o)throw n}}return i}},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.default=e.exports,e.exports.__esModule=!0},,function(e,t,a){var r=a(10);e.exports=function(e){if(Array.isArray(e))return r(e)},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){function a(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(e.exports=a=function(e){return typeof e},e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=a=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.default=e.exports,e.exports.__esModule=!0),a(t)}e.exports=a,e.exports.default=e.exports,e.exports.__esModule=!0},,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){a(49),a(50),a(51),a(52),a(53),a(54),a(55),a(56),a(57),a(58),a(59),a(60),a(61),a(62),a(63),a(64),e.exports=a(65)},function(e,t,a){"use strict";a.r(t);var r=a(22),n=a.n(r),i=a(8),o=a.n(i),l=a(9),s=a.n(l),c=a(5),u=a.n(c),d=a(4),p=a.n(d),f=a(11),v=a.n(f),m=a(12),g=a.n(m),w=a(6),y=a.n(w);function h(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){if(e){if("string"==typeof e)return b(e,void 0);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?b(e,void 0):void 0}}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==a.return||a.return()}finally{if(l)throw i}}}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function _(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_(Object(a),!0).forEach((function(t){p()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var x=lodash,T=window.wteL10n,S=T.api,C=T.util,D=T.priceFormat,P=T.dateFormat,j=function(){function e(t){var a,r=this;v()(this,e),this.bookingform=t,this.summaryTemplate=wp.template("wte-booking-summary"),this.datetimeTemplate=wp.template("wte-booking-datetime"),this.state={selectedPackage:null,selectedDate:P(null),selectedTime:P(null),packageCategories:{},travelerRecord:{},availablePackages:[],availableTimes:[],extraServices:{},loading:!0,defaultDateFormat:"YYYY-MM-DD",cart:{},formatPrice:function(e){var t,a=wteL10n,r=a.currency,n=a.baseCurrency,i=a.currencySymbol,o=a.format,l=o.number,s=o.price,c=p()({},n,1);if("undefined"!=typeof wteCc&&null!==(t=wteCc)&&void 0!==t&&t.code)for(var u in wteCc.code)c=k(k({},c),{},p()({},wteCc.code[u],wteCc.rate[u]));return e*=+c[r],wteL10n.helpers.priceFormat(e,r,i,s,+l.decimal,l.decimalSeparator,l.thousandSeparator)},groupPricings:{},cartTotal:{travelers:0}},this.extraServicesAPI=(a=this,function(){var e=a._store,t=e.getState().trip;if(!(t.trip_extras.length<1)){document.getElementById("wte-booking-extraservices-content").innerHTML=wp.template("wte-booking-extraservices")(),e.subscribe((function(){var t=e.getState().services||{},a="";for(var r in t){var n=t[r],i=null==n?void 0:n.meta.wte_services.service_type;a+=wp.template("wte-booking-es-".concat(i))({service:n,extraServices:e.getState().extraServices})}document.getElementById("wte-booking-extraservices__services").innerHTML=a,document.getElementById("wte-booking-es-summary-content").innerHTML=wp.template("wte-booking-es-summary")(e.getState())})),e.dispatch((function(a,r){var n;fetch("".concat(wteL10n.wpapi.root).concat(wteL10n.wpapi.versionString,"wte-services?include=").concat(null===(n=t.trip_extras)||void 0===n?void 0:n.join(","))).then((function(t){t.json().then((function(t){t&&e.dispatch({type:"UPDATE_STORE",data:{services:lodash.keyBy(t,"id")}})}))}))}));var r=function(t){var a,r,n=this.closest(".wte-booking-es-counter").dataset.info,i=n=n&&JSON.parse(n),o=i.serviceID,l=i.option,s=p()({},l,1),c=0;if(this.classList.contains("wte-up"))c=1;else{if(!this.classList.contains("wte-down"))return;c=-1}var d=e.getState(),f=d.extraServices,v=d.services,m=d.cartTotal,g=d.cart,w=c>0?1:0;if(f[o]&&(w=c>0?f[o][l]?+f[o][l].count+1:1:f[o][l]?+f[o][l].count-1:0),!(w<0)){var y=v[o]||{},h=null!==(a=null==y||null===(r=y.meta)||void 0===r?void 0:r.wte_services)&&void 0!==a?a:{},b=0,_="",x="unit";null!=h&&h.service_type&&("custom"===h.service_type?(_=h.options[l],b=+h.prices[l],x=h.service_unit):(_=y.title.rendered,b=+h.service_cost,x=h.service_unit)),s=k(k({},f[o]),{},p()({},l,{count:w<0?0:w,unitPrice:b,label:_,per:x}));var T=k(k({},f),{},p()({},o,s)),S=0,C=[];for(var D in T){var P=T[D];for(var j in P){var O=P[j];S+=+O.count*+O.unitPrice,+O.count>0&&(C=[].concat(u()(C),[{extra_service:O.label,qty:O.count,price:+O.unitPrice}]))}}g=k(k({},g),{},{extraServices:C}),e.dispatch({type:"UPDATE_STORE",data:{extraServices:T,cartTotal:k(k({},m),{},{services:S}),cart:g}})}};C.on("change",".wte-booking-es-select",(function(t){var a=this.dataset.info;a=a&&JSON.parse(a);var r,n=e.getState(),i=n.extraServices,o=n.services,l=a,s=l.serviceID,c=(l.option,o[s].meta.wte_services),u=c.options,d=c.service_unit,f=c.prices;r=k(k({},i),{},p()({},s,p()({},this.value,{count:0,label:u[this.value],per:d,unitPrice:f[this.value]}))),e.dispatch({type:"UPDATE_STORE",data:{extraServices:r}})})),C.on("click",".wte-booking-es-counter .wte-up",r),C.on("click",".wte-booking-es-counter .wte-down",r)}}),this._store=Redux.createStore((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.state,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_TRIP":return k(k({},e),{},{trip:t.data});case"UPDATE_STORE":return k(k({},e),t.data);case"SET_DATE":return k(k({},e),{},{selectedDate:t.date});case"SET_TIME":return k(k({},e),{},{selectedTime:t.data});case"SET_PACKAGE":return k(k({},e),{},{selectedPackage:t.data});case"SET_TRAVELER_RECORD":return k(k({},e),{},{travelerRecord:t.data});case"SET_TIME":case"SET_AVAILBLE_PACKAGES":case"SET_AVAILBLE_TIMES":default:return e}}),Redux.applyMiddleware((function(e){return function(t){return function(a){return"function"==typeof a?a(e.dispatch,e.getState):t(a)}}}))),this.unsubscriber=this._store.subscribe((function(){!r._store.getState().loading&&r._store.getState().trip&&(console.info("Initialize Booking Process",r._store.getState()),r.init())})),this._store.subscribe((function(){r.updateSelectedTime(),r.updateSummary(),r.updatePackageTabContent()})),this._store.dispatch(function(){var e=s()(y.a.mark((function e(t,a){var r,n,i,o,l;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.get("trip",{id:wte.trip.id});case 2:if(n=e.sent,i=null!==(r=n.packages_ids)&&void 0!==r?r:[],o=[],e.prev=5,i){e.next=8;break}throw new Error("No packages assigned to this trip - ".concat(n.id));case 8:return e.next=10,S.get("packages",{include:i.join(","),per_page:100});case 10:o=e.sent,e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5),console.warn("WTEBOOKING: "+e.t0.message);case 16:return e.next=18,S.get("categories");case 18:l=e.sent,t({type:"UPDATE_STORE",data:{loading:!1,trip:n,tripPackagesIds:i,tripPackages:o,pricingCategories:l,primaryCategory:Object.values(l).find((function(e){return e["is-primary"]}))}});case 20:case"end":return e.stop()}}),e,null,[[5,13]])})));return function(_x,t){return e.apply(this,arguments)}}()),this.priceFormat=function(e){return D(e)},this.cart={},this.currentTab=0,this.tabController={},this.timeformat="h:mm A",this.timeformatter=function(e){return wteL10n.format.datetime.timezone,moment(e).format(r.timeformat)},this.addToCart=function(){var e,t,a,n,i,o,l,s,c=wteL10n,u=c.wpxhr.root,d=c.tripID,f=c._nonces.addtocart,v=r._store.getState(),m=v.cart,g=v.selectedPackage,w=v.selectedDate,y=v.selectedTime,b=v.travelerRecord,_=v.cartTotal,x=v.packageCategories,T=v.groupPricings,S=v.trip;if(""!=S.min_pax&&+S.min_pax>m.traveler)alert(null===(a=wteL10n)||void 0===a||null===(n=a.l10n)||void 0===n||null===(i=n.invalidCartTraveler)||void 0===i?void 0:i.replace("%s",S.min_pax));else if(null===(e=m)||void 0===e||!e.traveler||m.traveler<1)alert(null===(o=wteL10n)||void 0===o||null===(l=o.l10n)||void 0===l||null===(s=l.invalidCartTraveler)||void 0===s?void 0:s.replace("%s",1));else{wteL10n.format.datetime.GMTOffset;var C=g,D=w.format("YYYY-MM-DD"),P=y.get()?y.format("YYYY-MM-DDTHH:mm"):"",j=b,O={};for(var E in _=Object.values(_).reduce((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;return+e+ +t})),j){var L=j[E];if(!(L<1)){var A=x[E],I={pax:L,salePrice:null!=A&&A.salePrice?+A.salePrice:0,groupDiscountPrice:0,cost:+A.price};if(A.enabledSale&&(I.cost=A.salePrice),A.enabledGroupDiscount&&T&&T[E]){var q,F=h(T[E]);try{for(F.s();!(q=F.n()).done;){var M=q.value;if(M.to.length<1){I.cost=M.price.length>0?+M.price:+A.price;break}if(L>=+M.from&&L<=+M.to){I.cost=M.price.length>0?+M.price:+A.price;break}}}catch(e){F.e(e)}finally{F.f()}}I.categoryInfo=A,O=k(k({},O),{},p()({},E,I))}}m=k(k({},m),{nonce:f,tripID:d,packageID:C,tripDate:D,tripTime:P,travelers:j,cartTotal:_,pricingOptions:O,cversion:(null===(t=wteL10n)||void 0===t?void 0:t.cart_version)||"2.0"}),fetch("".concat(u,"?action=wte_add_trip_to_cart&cart_version=").concat(m.cversion,"&_nonce=").concat(f),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)}).then((function(e){return e.json().then((function(e){var t,a;e.success?window.location.href=null===(t=window)||void 0===t||null===(a=t.wp_travel_engine)||void 0===a?void 0:a.CheckoutURL:e.data&&e.data[0]&&alert(e.data[0])}))}))}}}var t;return g()(e,[{key:"init",value:function(){this.unsubscriber(),this.loadTemplates(),this.initTabController(),this.initCalendar(),this.eventListeners(),this.bookingProcessFlowControl()}},{key:"initTabController",value:function(){var e,t=this,a=this.bookingform.querySelectorAll(".wte-process-nav-item"),r=this.bookingform.querySelectorAll(".wte-process-tab-item");this.tabController={tabCount:null==a?void 0:a.length,navigators:a,activeTab:"wte-booking-datetime",activeClass:"active",completedClass:"finish",nextBtn:"#wteProcessNext",prevBtn:"#wteProcessPrev",toggleNextBtn:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],a=document.querySelector(t.nextBtn);a&&(a.disabled=e)},finalAction:(e=this,function(){e.addToCart()}),validToNextProcess:function(e){return function(){var t=e.tabController,a=document.querySelector(t.nextBtn);switch(t.activeTab){case"wte-booking-datetime":var r=e._store.getState(),n=r.selectedDate,i=r.availableTimes,o=r.selectedTime;return n&&(null==n?void 0:n.get())&&(Object.keys(i).length<1||Object.keys(i).length&&(null==o?void 0:o.get()));case"wte-booking-packages":var l=e._store.getState().cart;return null!=l&&l.traveler&&l.traveler>0?(a.disabled=!1,!0):(a.disabled=!0,!1);default:return!0}}}(this),switchBtnText:function(){var e=WTEBooking.tabController,t=document.querySelector(e.nextBtn);e.getActiveTabIndex()>=e.tabCount-1?t.textContent=t.dataset.labelCheckout||"Add to Cart":t.textContent=t.dataset.labelDefault||"Continue"},getActiveTabIndex:function(){var e=document.getElementById(this.activeTab);return Array.prototype.indexOf.call(r,e)},handleProcessBtnClick:function(e){var t=WTEBooking.tabController;if(this.matches(t.prevBtn))t.activeTab=r[t.getActiveTabIndex()-1].id;else if(this.matches(t.nextBtn)){var a=t.getActiveTabIndex()+1;if(a>=t.tabCount)t.finalAction();else{var n=r[a].id;t.validToNextProcess()&&(t.activeTab=n)}}t.switchBtnText(),t.getActiveTabIndex()>0?document.querySelector(t.prevBtn).style.removeProperty("display"):document.querySelector(t.prevBtn).style.display="none",t.showActiveTab()},init:function(){this.showActiveTab();var e=+this.getActiveTabIndex();e<1&&(document.querySelector(this.prevBtn).style.display="none"),document.querySelector(".wte-process-nav-list").style.setProperty("--step-bar-width","".concat((e+1)/3*100,"%")),C.on("click",this.nextBtn,this.handleProcessBtnClick),C.on("click",this.prevBtn,this.handleProcessBtnClick)},showActiveTab:function(){var e=+this.getActiveTabIndex();if(e<0)e=0;else if(e>=this.tabCount)e=this.tabCount-1;else{var t=document.querySelector(".wte-process-nav-list");for(var a in t.style.setProperty("--step-bar-width","".concat((e+1)/3*100,"%")),Array.from(this.navigators)){var n=this.navigators[a];if(a<=e){if(a<e?n.classList.add(this.completedClass):n.classList.add(this.activeClass),a==e){for(var i in Array.from(r))r[i].style.removeProperty("display");document.querySelector("a"===n.tagName.toLowerCase()?n.hash:n.dataset.target).style.display="block"}}else n.classList.remove(this.activeClass,this.completedClass)}}}},this.tabController.init()}},{key:"getJSONData",value:function(){return{trip:this.trip,tripPackages:this.tripPackages,availablePackages:this.availablePackages,selectedPackage:this.selectedPackage,packageCategories:this.getPackageCategories(this.selectedPackage),travelerRecord:this.travelerRecord,groupPricings:this.selectedPackage?this.tripPackages[this.selectedPackage]["group-pricing"]:{},formatPrice:this.formatPrice,selectedDate:this.selectedDate,cartTotal:this.calculateCartTotal(),selectedTime:this.selectedTime,availableTimes:this.availableTimes,extraServices:this.extraServices}}},{key:"loadTemplates",value:function(){document.getElementById("wte-booking-datetime-content").innerHTML=this.datetimeTemplate(this._store.getState()),document.getElementById("wte-booking-packages-content").innerHTML=wp.template("wte-booking-packages")(this._store.getState()),document.getElementById("wte-booking-summary").innerHTML=wp.template("wte-booking-summary")(this._store.getState()),document.dispatchEvent(new Event("wteLoadBookingTemplates"))}},{key:"calculateCartTotal",value:function(){var e=this.travelerRecord,t=0;for(var a in e){var r=e[a],n=this.getPackageCategories(this.selectedPackage)[a],i=n.enabledSale?+n.salePrice:+n.price,o=this.selectedPackage?this.tripPackages[this.selectedPackage]["group-pricing"]:{};if(Object.keys(o).length>0&&o[a]){var l,s=h(o[a]);try{for(s.s();!(l=s.n()).done;){var c=l.value;if(c.to.length<1){i=c.price||i;break}if(+r>=+c.from&&+r<=+c.to){i=c.price;break}}}catch(e){s.e(e)}finally{s.f()}}t+=i*+r}return t}},{key:"eventListeners",value:function(){var e;C.on("click",".wte-package-select-btn",(e=this,function(t){var a=this.dataset.packageId,r=e._store.getState().tripPackages,n=e.getDefaultCart(a);e._store.dispatch({type:"UPDATE_STORE",data:k({selectedPackage:a,packageCategories:e.getPackageCategories(a),groupPricings:a?r[a]["group-pricing"]:{}},n)})}));var t=function(e){return function(t){var a,r=0;if(this.classList.contains("wte-up"))r=1;else{if(!this.classList.contains("wte-down"))return;r=-1}var n=e._store.getState(),i=n.travelerRecord,o=n.cart,l=n.cartTotal,s=n.packageCategories,c=n.tripPackages,d=n.selectedPackage,f=n.trip,v=n.selectedTime,m=n.selectedDate,g=n.parentDateConfig,w=k({},o),y=k({},i),b=this.parentElement.dataset.info,_=(b=b&&JSON.parse(b)).catID;if(!(y[_]<1&&r<0)){var x=0;if(r>0?(x=y[_]?+y[_]+1:1,w.traveler=null!=w&&w.traveler?+w.traveler+1:1):(x=y[_]&&y[_]>=1?+y[_]-1:0,w.traveler=null!=w&&w.traveler?+w.traveler-1:0),!(x<0)){var T=s[_].minPax;T&&x<T&&(w.traveler=w.traveler-r*(1-T),x=r<0?0:T);var S=s[_].maxPax;if(S&&x>S&&(w.traveler=w.traveler-1,x=S),""!=f.max_pax&&+f.max_pax<w.traveler){var C,D,P;alert(null===(C=wteL10n)||void 0===C||null===(D=C.l10n)||void 0===D||null===(P=D.availableSeatsExceed)||void 0===P?void 0:P.replace("%s",f.max_pax))}else{var j=-1;if(v.get()){var O=v.format("YYYY-MM-DD-HH-mm-ss").split("-");O[1]=O[1]-1,j=.001*new Date(Date.UTC.apply(Date,u()(O))).getTime()}else if(null!=m&&m.get()){var E=m.format("YYYY-MM-DD").split("-");E[1]=E[1]-1,j=.001*new Date(Date.UTC.apply(Date,u()(E))).getTime()}if(g&&f["booked-seats"]&&f["booked-seats"][j]&&parseInt(null===(a=f["booked-seats"][j])||void 0===a?void 0:a.booked)){var L,A,I,q=g&&null!=g&&g._seats?parseInt(g._seats)-parseInt(f["booked-seats"][j].booked):-1;if(""!==g._seats&&q>-1&&q<w.traveler)return void alert(null===(L=wteL10n)||void 0===L||null===(A=L.l10n)||void 0===A||null===(I=A.availableSeatsExceed)||void 0===I?void 0:I.replace("%s",q))}else if(g){var F,M,B;if(parseInt(g._seats)<+w.traveler)return void alert(null===(F=wteL10n)||void 0===F||null===(M=F.l10n)||void 0===M||null===(B=M.availableSeatsExceed)||void 0===B?void 0:B.replace("%s",g._seats))}y=k(k({},y),{},p()({},_,x));var R=0;for(var $ in y){var Y=y[$],U=s[$],Q=U.enabledSale?+U.salePrice:+U.price,H=c[d]["group-pricing"]||{};if(U.enabledGroupDiscount&&Object.keys(H).length>0&&H[$]){var N,W=h(H[$]);try{for(W.s();!(N=W.n()).done;){var G=N.value;if(G.to.length<1){Q=G.price||Q;break}if(+Y>=+G.from&&+Y<=+G.to){Q=G.price;break}}}catch(e){W.e(e)}finally{W.f()}}R+="per-group"===U.pricingType?Y&&+Q||0:Q*+Y}e._store.dispatch({type:"UPDATE_STORE",data:{travelerRecord:y,cart:w,cartTotal:k(k({},l),{},{travelers:R})}})}}}}};C.on("click",".wte-booking-pc-counter .wte-down",t(this)),C.on("click",".wte-booking-pc-counter .wte-up",t(this)),C.on("click",".wte-time-select-btn",function(e){return function(t){var a,r=this.dataset.time,n=this.dataset.packageId.split(","),i=e._store.getState().tripPackages;if(null!=e&&null!==(a=e.tabController)&&void 0!==a&&a.nextBtn){var o=document.querySelector(e.tabController.nextBtn);o&&(o.disabled=!1)}r&&e._store.dispatch({type:"UPDATE_STORE",data:{selectedTime:P(new Date(+r)),availablePackages:n.map((function(e){return i[e]})),selectedPackage:n[0]}})}}(this))}},{key:"getPackageCategories",value:function(e){return e?this._store.getState().tripPackages[e]["package-categories"]:{}}},{key:"clear",value:function(){this._store.dispatch({type:"UPDATE_STORE",data:{selectedDate:P(null),selectedTime:P(null),selectedPackage:null,defaultDateFormat:"YYYY-MM-DD",packageCategories:{},travelerRecord:{},cart:{}}})}},{key:"updateSelectedTime",value:function(){document.getElementById("wte-booking-times-content").innerHTML=wp.template("wte-booking-times")(this._store.getState())}},{key:"getDefaultCart",value:function(e){if(e){var t=this._store.getState(),a=t.tripPackages,r=t.trip,n=this.getPackageCategories(e),i={},o={traveler:0},l=0,s=null==r?void 0:r.primary_category;if(!n[s])return{cart:o,cartTotal:{travelers:l},travelerRecord:i};var c=n[s],u=s,d=c.enabledSale?+c.salePrice:+c.price,p=parseInt(c.minPax);i[u]=p;var f=a[e]["group-pricing"]||{};if(c.enabledGroupDiscount&&Object.keys(f).length>0&&f[u]){var v,m=h(f[u]);try{for(m.s();!(v=m.n()).done;){var g=v.value;if(g.to.length<1){d=g.price||d;break}if(p>=+g.from&&p<=+g.to){d=g.price;break}}}catch(e){m.e(e)}finally{m.f()}}return o.traveler=parseInt(o.traveler)+p,{cart:o,cartTotal:{travelers:l+="per-group"===c.pricingType?p&&+d||0:d*p},travelerRecord:i}}}},{key:"bookingProcessFlowControl",value:function(e){var t=this;e||this.bookingform.classList.add("wte-bp-flow");var a=document.getElementById("wte-booking-datetime"),r={dateChange:function(){if(a&&t.bookingform.classList.contains("wte-bp-flow")){var e=a.offsetHeight,r=a.children;if(r[0]){var n=r[0].offsetHeight;!function t(){a.scrollTop<n-e&&(a.scrollTop=n-e>a.scrollTop?a.scrollTop+10:a.scrollTop,setTimeout(t))}()}}}};r[e]&&r[e]()}},{key:"initCalendar",value:function(){var e=this,t=this.getPackagesDates(),a=Object.values(t._nodates);delete t._nodates;var r=this._store.getState(),n=r.tripPackages,i=r.trip;r.cart,console.debug({_dates:t});var l=t._minDate;delete t._minDate;var s,c,d={minDate:l,inline:!0,onChange:function(a,r){var l,s;a[0].getTimezoneOffset(),a=new Date(a[0].getTime());var c=moment(a).format("YYYY-MM-DD");e.clear();var d=[];t[c]&&(d=Object.keys(t[c]).map((function(e){return n[e]})));var p=Object.values(n).filter((function(e){return Object.values(e["package-dates"]).length<1})),f=(d=[].concat(u()(d),u()(p))).map((function(e){return e.id})),v=(null==i||null===(l=i.packages_ids)||void 0===l?void 0:l.find((function(e){return f.indexOf(e)>-1})))||d[0].id,m={},g=e.getDefaultCart(v),w=t[c]&&t[c][v]||null;if(t[c])for(var y=0,h=Object.entries(t[c]);y<h.length;y++){var b=o()(h[y],2),_=b[0],x=b[1];if(!(x._times.length<1))for(var T in x._times){var S,C,D=x._times[T],j=null==D||null===(S=D.from)||void 0===S?void 0:S.split(":"),O=new Date(a);O.setHours(j[0]),O.setMinutes(j[1]);var E=null==D||null===(C=D.to)||void 0===C?void 0:C.split(":"),L=new Date(a);L.setHours(E[0]),L.setMinutes(E[1]);var A="_"+moment(O).format("HH-mm")+"_"+moment(L).format("HH-mm");if(m[A])m[A].packages=[].concat(u()(m[A].packages),[_]);else{var I=!0,q=i["booked-seats"],F=.001*O.getTime();if(q&&q[F]){var M,B,R,$,Y;I=!(null===(M=q[F])||void 0===M||!M.booked)&&+(null===(B=q[F])||void 0===B?void 0:B.booked)>0;var U=null!=w&&w._seats&&null!==(R=q[F])&&void 0!==R&&R.booked?+w._seats-+q[F].booked:-1;I=!(null!=g&&null!==($=g.cart)&&void 0!==$&&$.traveler)&&U>0&&U>(null==g||null===(Y=g.cart)||void 0===Y?void 0:Y.traveler)}m[A]={from:O,to:L,packages:[_],formatter:e.timeformatter,isAvailable:I}}}}var Q=document.querySelector(null===(s=e.tabController)||void 0===s?void 0:s.nextBtn);a&&Object.values(m).length<=0?Q&&(Q.disabled=!1):Q&&(Q.disabled=!0),e._store.dispatch({type:"UPDATE_STORE",data:k(k({},g),{},{parentDateConfig:w,selectedDate:P(a),availablePackages:d,selectedPackage:v,availableTimes:m,packageCategories:e.getPackageCategories(v),groupPricings:v?n[v]["group-pricing"]:{}})}),e.bookingProcessFlowControl("dateChange")},disable:[function(e){return!1}],onReady:function(){var e,t=document.getElementById("open-booking-modal");if(t&&(t.disabled=!1),(null===(e=window.location.search)||void 0===e?void 0:e.split("&").indexOf("action=fsd_booking"))>-1){var a,r,n=null===(a=window.location.search)||void 0===a?void 0:a.replace("?","").split("&").map((function(e){return e.split("=")})).find((function(e){return"date"===e[0]}));t.click(),null===(r=arguments.length<=2?void 0:arguments[2])||void 0===r||r.setDate(n,!0)}document.dispatchEvent(new Event("bookingCalendarReady"))}};d.disable=[(s=k({},t),c=l,function(e){return!(!l||a.length>0&&moment(e).isSameOrAfter(c)||s[moment(e).format("YYYY-MM-DD")])})],flatpickr("#wte-booking-date-calendar",d)}},{key:"formatPrice",value:function(e){var t,a=wteL10n,r=a.currency,n=a.baseCurrency,i=a.currencySymbol,o=a.format,l=o.number,s=o.price,c=p()({},n,1);if("undefined"!=typeof wteCc&&null!==(t=wteCc)&&void 0!==t&&t.code)for(var u in wteCc.code)c=k(k({},c),{},p()({},wteCc.code[u],wteCc.rate[u]));return e*=+c[r],wteL10n.helpers.priceFormat(e,r,i,s,+l.decimal,l.decimalSeparator,l.thousandSeparator)}},{key:"updateSummary",value:function(){document.getElementById("wte-booking-summary").innerHTML=wp.template("wte-booking-summary")(this._store.getState())}},{key:"updatePackageTabContent",value:function(){document.getElementById("wte-booking-packages-content").innerHTML=wp.template("wte-booking-packages")(this._store.getState())}},{key:"_dateToUTC",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("invalid date"!==(e=new Date(moment(e).tz("utc").toDate())).toString().toLowerCase()){var a=0,r=0;if(t){var n=t.split(":");a=+n[0],r=+n[1]}return new Date(Date.UTC(e.getUTCFullYear(),e.getMonth(),e.getDate(),a,r,0,0))}return e}},{key:"_dateToTripTimeZone",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("invalid date"!==(e=new Date(e)).toString().toLowerCase()){if(e.setHours(0),e.setMinutes(0),e.setSeconds(0),t){var a=t.split(":");e.setHours(+a[0]),e.setMinutes(+a[1])}var r="".concat(moment(e).format("YYYY-MM-DDTHH:mm:ss")).concat(wteL10n.format.datetime.timezone);return new Date(r)}return e}},{key:"getPackagesDates",value:function(){var e,t=this._store.getState(),a=t.tripPackages,r=t.trip,n={_nodates:[]},i=new Date;for(var o in i.setHours(0),i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0),null!==(e=r.cut_off_time)&&void 0!==e&&e.enabled&&(i=moment(i).add(r.cut_off_time.duration,r.cut_off_time.duration_unit).toDate()),a){var l=a[o]["package-dates"];if(l&&Object.values(l).length<1)n._nodates=[].concat(u()(n._nodates),[o]);else for(var s in l){var c=l[s],d=x.get(c,"dtstart",null);d=d.split("-");var f=new Date(Date.UTC(d[0],+d[1]-1,d[2],0,0,0,0)),v=f.getTime(),m=f,g=x.get(c,"times",[]),w=x.get(c,"rrule",{}),y=!!x.get(c,"is_recurring",!1),h=x.get(c,"seats","");if(moment(m).isSameOrAfter(i)){var b=.001*v;if(""!==h&&r["booked-seats"]&&r["booked-seats"][+b]&&parseInt(r["booked-seats"][+b].booked)>=+h);else{var _=d.join("-");(!n._minDate||+n._minDate>moment(_).valueOf())&&(n._minDate=moment(_).valueOf()),n[_]=k(k({},n[_]?n[_]:{}),{},p()({},o,{_times:g,_rrule:w,_isRecurring:y,_seats:h}))}}if(y){var T=null!=w?w:{},S=T.r_frequency,C=T.r_until,D=T.r_weekdays,P=T.r_months,j=T.r_count,O={freq:S?rrule.RRule[S.toUpperCase()]:rrule.RRule.DAILY,dtstart:f};if(C){var E=this._dateToUTC(C);if(moment(i).isAfter(E))continue;O.until=E}switch(O.count=j?+j:10,S){case"WEEKLY":O.byweekday=D&&Object.values(D).map((function(e){return rrule.RRule[e]}))||[];break;case"MONTHLY":O.bymonth=P&&Object.keys(P).map((function(e){return+e}))||[]}var L=new rrule.RRule(O).all(),A=0;for(var I in L){var q=L[I];if(!moment(q.getTime()).isBefore(i)){0==I&&(A=O.dtstart.getTime()-q.getTime());var F=q.getTime()+A;if(!(""!==h&&r["booked-seats"]&&r["booked-seats"][F]&&parseInt(r["booked-seats"][F].booked)>=+h)){var M=moment.tz(moment(q).toISOString(),"UTC").format("YYYY-MM-DD"),B=moment(M).valueOf();(!n._minDate||+n._minDate>B)&&(n._minDate=B),n[M]=k(k({},n[M]?n[M]:{}),{},p()({},o,{_times:g,_rrule:w,_isRecurring:y,_seats:h}))}}}}}}return n._minDate||(n._minDate=i),n}},{key:"fetchData",value:(t=s()(y.a.mark((function e(){var t,a=arguments;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:null,e.next=4,S.get("trip",{id:wte.trip.id});case 4:if(this.trip=e.sent,this.tripPackagesIds=this.trip.packages_ids||[],e.prev=6,"object"===("undefined"==typeof tripPackagesIds?"undefined":n()(tripPackagesIds))){e.next=9;break}throw"Trip Error: No Packages Assign to the trip - ".concat(this.trip.id,".");case 9:return e.next=11,S.get("packages",{include:this.tripPackagesIds.join(","),per_page:100});case 11:this.tripPackages=e.sent,e.next=18;break;case 14:e.prev=14,e.t0=e.catch(6),this.tripPackages=[],console.debug("WTE Booking: ".concat(e.t0.message));case 18:return e.next=20,S.get("categories");case 20:this.pricingCategories=e.sent,t&&t();case 22:case"end":return e.stop()}}),e,this,[[6,14]])}))),function(){return t.apply(this,arguments)})}]),e}();window.addEventListener("load",(function(){var e=document.getElementById("wte__booking");if(e){var t=new j(e);window.WTEBooking=t,jQuery("#open-booking-modal").fancybox({type:"inline",src:"#wte__booking",baseClass:"wte-fb-popup"})}}))},function(e,t){jQuery(document).ready((function(e){var t=!1;"1"==rtl.enable&&(t=!0),e(".wpte-trip-feat-img-gallery").owlCarousel({nav:!0,navigationText:["&lsaquo;","&rsaquo;"],items:1,autoplay:!0,slideSpeed:300,paginationSpeed:400,center:!0,loop:!0,rtl:t,dots:!1})}))},function(e,t,a){"use strict";a.r(t);var r=a(4),n=a.n(r);jQuery((function(e){var t=e(".wpte-bf-step.active"),a=e(".wpte-bf-step-content.active"),r=!1;function i(e,t){if(""==window.wte_fix_date.enabled)return t;try{for(var a=wte_fix_date.cost.length,r=0;r<a;r++){if(wte_fix_date.use_multi_prices)return t;var n=e.split("-").map((function(e){return+e})).join("-"),i=wte_fix_date.cost[r][n];if(void 0!==i)return i}}catch(e){return t}return t}function o(){if(e("body").hasClass("single-trip")){var t=function(){var t=e('.wpte-bf-content-travellers .wpte-bf-number-field > input[type="text"]'),a=0;return e.each(t,(function(e,t){var r=l(t);a+=r})),a}();window.wte.trip.travellersCost=t;var a=calculateGrandTotal(),r=(wteGetFormatedPriceWithCurrencyCodeSymbol(t,wte.currency.code,wte.currency.symbol),wteGetFormatedPrice(a)),n=wteGetFormatedPriceWithCurrencyCodeSymbol(a,wte.currency.code,wte.currency.symbol);wteGetFormatedPriceWithCurrencyCodeSymbol(wte.trip.price,wte.currency.code),window.wteCartFields["trip-cost"]=a,e(".wpte-bf-total-price > .wpte-price").html(r);var o=e('.wpte-bf-content-travellers .wpte-bf-number-field > input[type="text"]'),s="";e.each(o,(function(t,a){var r=e(a).val(),n=e(a).data("cartField"),o=e(a).data("type"),c=e(a).data("costField"),u=l(a),d=wteGetFormatedPriceWithCurrencyCodeSymbol(u,wte.currency.code,wte.currency.symbol),p=e(a).data("pricing-type")||"per-person";window.wteCartFields[n]=r,window.wteCartFields[c]=u,r>1&&("group"==o||"per-group"===p)&&(r=1),-1!==e.inArray(o,Object.keys(wte.pax_labels))&&(o=wte.pax_labels[o]);var f=o.charAt(0).toUpperCase()+o.substring(1);r>1&&"traveler"==o?f="Travelers":r>1&&"child"==o?f="Children":r>1&&"Adult"==o||"adult"==o?f="Adults":r>1&&("group"==o||"per-group"===p)&&(r=1);var v=u/r;if(!isFinite(v)){""==(v=e(a).data("cost"))&&(v=0);try{v=i(window.wteCartFields["trip-date"],v)}catch(e){}}v=(v=parseFloat(v)).toFixed(2);var m=wteGetFormatedPriceWithCurrencySymbol(v,wte.currency.symbol),g=(wteGetFormatedPrice(v),wteGetFormatedPriceWithCurrencyCodeSymbol(v,wte.currency.code,wte.currency.symbol));jQuery(this).parents(".wpte-bf-traveler-block").find(".wpte-bf-price ins").html(g),0!=u&&(s+="\n                <tr>\n                    <td>".concat(r," x ").concat(f,' <span class="wpte-bf-info">(').concat(m,"/").concat(o,")<span></span></td>\n                    <td>").concat(d,"</td>\n                </tr>\n            "))})),e(".wpte-bf-travellers-price-table tbody").html(s),e(".wte-bf-price-detail .wpte-bf-total").html("\n            ".concat(wte.totaltxt," <b>").concat(n,"</b>\n        "))}}function l(t){var a=e(t).val(),r=e(t).data("cost");(isNaN(r)||""==r)&&(r=0);try{r=parseFloat(i(window.wteCartFields["trip-date"],r))}catch(e){}var n=e(t).data("type"),o=e(t).data("pricing-type")||"per-person";if(("group"==n||"per-group"==o)&&a>0)l=parseFloat(r);else var l=parseInt(a)*parseFloat(r);try{l=parseFloat(applyGroupDiscount(a,n,l))}catch(e){}return l}window.wteCartFields={action:"wte_add_trip_to_cart",nonce:e("#nonce").val(),"trip-id":wte.trip.id,travelers:1,"trip-cost":wte.trip.price},toastr.options.positionClass="toast-bottom-full-width",toastr.options.timeOut="10000",e(document).on("click",".wpte-bf-toggle-wrap .wpte-bf-toggle-title",(function(t){t.preventDefault(),e(this).parents(".wpte-bf-toggle-wrap").toggleClass("active"),e(this).siblings(".wpte-bf-toggle-content").fadeToggle("slow",(function(){e(this).is(":visible")?(e(this).siblings(".wpte-bf-toggle-title").find(".wtebf-toggle-title").hide(),e(this).siblings(".wpte-bf-toggle-title").find(".wtebf-toggle-title-active").show()):(e(this).siblings(".wpte-bf-toggle-title").find(".wtebf-toggle-title").show(),e(this).siblings(".wpte-bf-toggle-title").find(".wtebf-toggle-title-active").hide())}))})),jQuery(".wpte-bf-content-travellers .wpte-bf-number-field").each((function(){var t=jQuery(this),a=t.find('input[type="text"]'),r=t.find(".wpte-bf-plus"),n=t.find(".wpte-bf-minus");a.attr("min"),a.attr("max"),r.on("click",(function(a){a.preventDefault();var r=e(this).parent().find("input"),n=e(r).attr("max"),i=parseFloat(r.val());++i>=n&&(i=n),t.find("input").val(i),t.find("input").trigger("change");var l=e(this).parents(".wpte-bf-number-field").find('input[type="text"]').data("cartField");window.wteCartFields[l]=i,o()})),n.on("click",(function(a){a.preventDefault();var r=e(this).parent().find("input"),n=e(r).attr("min"),i=parseFloat(r.val());--i<=n&&(i=n),t.find("input").val(i),t.find("input").trigger("change");var l=e(this).parents(".wpte-bf-number-field").find('input[type="text"]').data("cartField");window.wteCartFields[l]=i,o()}))}));var s=[];try{for(var c=wte_fix_date.cost.length,u=0;u<c;u++)s.push(Object.keys(wte_fix_date.cost[u])[0])}catch(e){}function d(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0))}var p={};function f(e){if(wte.booking_cutoff.enable&&parseInt(wte.booking_cutoff.cutoff)>0){var t=d(new Date),a=60*parseInt(wte.booking_cutoff.cutoff)*60*1e3;if(a="days"===wte.booking_cutoff.unit?24*a:a,bookableDate=new Date(t.getTime()+a),d(e).getTime()<d(bookableDate).getTime())return[]}if(!wte_fix_date.departureDates)return s.map((function(e){return d(new Date(e))}));var r=wte_fix_date.departureDates,i=r.sdate?Object.keys(r.sdate):[],o=new rrule.RRuleSet;return i.forEach((function(t){var a=new rrule.RRuleSet,i=void 0!==r&&void 0!==r[t]?r[t].recurring:null;if(i&&"true"==i.enable){var l={},s=new Date(i.until);if(new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0)).getTime()>new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),0,0,0,0)).getTime())return;l.freq=rrule.RRule[i.type];var c=d(new Date(r.sdate[t]));l.dtstart=c,i.months&&"MONTHLY"==i.type&&(l.bymonth=Object.values(i.months).map((function(e){return+e})),l.dtstart.setDate(c.getDate())),i.week_days&&"WEEKLY"==i.type&&(l.byweekday=Object.values(i.week_days).map((function(e){return rrule.RRule[e]}))),l.count=+i.limit||10,o.rrule(new rrule.RRule(l)),a.rrule(new rrule.RRule(l)),a.all().forEach((function(e){if(!p[e.getTime()]){p[e.getTime()]=!0;var a=e.getFullYear()+"-"+(+e.getMonth()+1)+"-"+e.getDate();wte_fix_date.cost.push(n()({},a,r.cost[t]));var i=wte_fix_date.bookedSeats[e.getTime()]&&wte_fix_date.bookedSeats[e.getTime()].booked||0,o=+r.seats_available[t]-+i;wte_fix_date.seats_available.push(n()({},a,o)),wte_fix_date.fdd_ids.push(n()({},a,e.getTime()))}}))}else{var u=new Date(r.sdate[t]);if(wte.booking_cutoff.enable&&parseInt(wte.booking_cutoff.cutoff)>0){var f=new Date;f=new Date(Date.UTC(f.getFullYear(),f.getMonth(),f.getDate(),0,0,0,0));var v=60*parseInt(wte.booking_cutoff.cutoff)*60*1e3;v="days"===wte.booking_cutoff.unit?24*v:v,bookableDate=new Date(f.getTime()+v),d(u).getTime()>=d(bookableDate).getTime()&&o.rdate(u)}else d(u).getTime()>=d(new Date).getTime()&&o.rdate(u);if(p[u.getTime()])return;p[u.getTime()]=!0;var m=u.getFullYear()+"-"+(+u.getMonth()+1)+"-"+u.getDate();wte_fix_date.cost.push(n()({},m,r.cost[t]));var g=wte_fix_date.bookedSeats[u.getTime()]&&wte_fix_date.bookedSeats[u.getTime()].booked||0,w=+r.seats_available[t]-+g;wte_fix_date.seats_available.push(n()({},m,w)),wte_fix_date.fdd_ids.push(n()({},m,u.getTime()))}})),o.all()}function v(t){var a=e.datepicker.formatDate(e.datepicker.ISO_8601,t),r=new Date;r=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),0,0,0,0));var n=null;if(wte.booking_cutoff.enable&&parseInt(wte.booking_cutoff.cutoff)>0){var i=60*parseInt(wte.booking_cutoff.cutoff)*60*1e3;i="days"===wte.booking_cutoff.unit?24*i:i,n=new Date(r.getTime()+i),n=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0,0))}else n=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),0,0,0,0));if(!wte_fix_date||wte_fix_date.departureDates&&!wte_fix_date.departureDates.cost)return d(t)>=d(n)?[!0,"","Available"]:[!1,"","Unavailable"];var o=f(t).filter((function(e){return d(e)>=n})).map((function(e){return e.getTime()}));if(o.length<=0&&d(t)>=d(n))return[!0,"","Available"];for(var l=wte_fix_date.seats_available.length,s=0;s<l;s++)if(wte_fix_date.seats_available[s][a]){if("0"==wte_fix_date.seats_available[s][a]||""==wte_fix_date.seats_available[s][a])return[!1,"","Unavailable"];break}return $recurredDate=o.find((function(e){return new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0)).getTime()===e})),$recurredDate?[!0,"","Available"]:[!1,"","Unavailable"]}function m(n){if(!r)return!1;t=n;var i=e(".wpte-bf-step"),o=e(i).index(n);e(a).fadeOut("slow",(function(){e(t).addClass("active"),e(a).removeClass("active"),a=e(".wpte-bf-step-content")[o],e(a).css("display",""),e(a).css("opacity",""),e(a).addClass("active"),0===o?e(".wte-bf-price-detail").css("display","none"):e(".wte-bf-price-detail").css("display",""),o+1>=i.length?e('.wte-bf-price-detail .wpte-bf-btn-wrap input[type="button"]').val(wte.bookNow):e('.wte-bf-price-detail .wpte-bf-btn-wrap input[type="button"]').val(wte_strings.bookingContinue||"Continue")}))}function g(t){var a=e(".wpte-bf-step"),r=e(a).index(t);return!(r+1>=a.length)&&a[r+1]}e(".wpte-bf-datepicker").datepicker({minDate:0,beforeShowDay:"undefined"!=typeof wte_fix_date&&wte_fix_date.departureDates&&"1"==wte_fix_date.enabled?v:0==s.length||"undefined"!=typeof wte_fix_date&&""==window.wte_fix_date.enabled?function(e){if(wte.booking_cutoff.enable&&parseInt(wte.booking_cutoff.cutoff)>0){var t=new Date,a=new Date(e.getTime()+864e5),r=60*parseInt(wte.booking_cutoff.cutoff)*60*1e3;if(r="days"===wte.booking_cutoff.unit?24*r:r,new Date(t.getTime()+r).getTime()>a.getTime())return[!1,"","Unavailable"]}return[!0,"","Available"]}:v,dateFormat:"yy-mm-dd",onSelect:function(a,n){r=!0;var i=g();if(i&&(e(".wpte-bf-step").removeClass("active"),e(t).removeClass("active"),m(i)),window.wteCartFields["trip-date"]!=a){window.wteCartFields["trip-date"]=a;try{if(""==window.wte_fix_date.enabled)return}catch(e){}try{for(var l=wte_fix_date.seats_available.length,s=0;s<l;s++){var c=wte_fix_date.seats_available[s][a];if(wte_fix_date.cost[s][a],void 0!==c){var u=e(".wpte-bf-content-travellers").find('input[type="text"]');e.each(u,(function(t,a){var r=e(a).data("cartField"),n="travelers"==r||"pricing_options[adult][pax]"==r?1:0;e(a).val(n),e(a).attr("max",c),e(".wpte-bf-content-travellers").data("maxtravellers",c)}))}}}catch(e){}o()}}}),e('.wpte-bf-btn-wrap > input[type="button"]').on("click",(function(a){a.preventDefault();var r=g(t);if(r){if("wpte-bf-step-travellers"==t.dataset.stepName||"travellers"==t.innerText.toLowerCase()){var n=0;e(".wpte-bf-content-travellers").find("input").each((function(t,a){n+=parseInt(e(a).val(),10)}));var i=parseInt(e(".wpte-bf-content-travellers").data("mintravellers")),o=parseInt(e(".wpte-bf-content-travellers").data("maxtravellers"));if(!(n>=i&&n<=o)){var l=wte_strings.pax_validation.replace("%2$s",i).replace("%3$s",o).replace("%1$s",n);return toastr.error(l),!1}e(".wpte-bf-step").removeClass("active"),e(t).removeClass("active"),m(r)}}else e.ajax({type:"POST",url:WTEAjaxData.ajaxurl,data:window.wteCartFields,success:function(t){var a;if(t.success)e("#price-loading").fadeOut(500),location.href=wp_travel_engine.CheckoutURL;else for(a=0;a<t.data.length;a++)toastr.error(t.data[a])}})})),e("#wpte-booking-form").on("click",".wpte-bf-step",(function(t){if(t.preventDefault(),!r)return!1;e(".wpte-bf-step").removeClass("active"),e(this).removeClass("active"),m(this)})),document.getElementById("wpte-booking-form")&&o()}))},function(e,t){jQuery(document).ready((function(e){e(".disabled_______book-submit").click((function(t){t.preventDefault();var a="#"+e(this).data("formid"),r={};e(a+" input, "+a+" select").each((function(t){if(filterby=e(this).attr("name"),filterby_val=e(this).val(),1==e(this).data("multiple")){if(void 0===r[filterby]&&(r[filterby]=[]),"checkbox"==e(this).attr("type")&&e(this).is(":checked")&&r[filterby].push(filterby_val),1==e(this).data("dependent")){var a=e(this).data("parent");e("#"+a).is(":checked")&&r[filterby].push(filterby_val)}}else r[filterby]=filterby_val})),r.action="wte_add_trip_to_cart",r.tid=r["trip-id"],e.ajax({type:"POST",url:wp_travel_engine.ajaxurl,data:r,beforeSend:function(){e("#price-loading").fadeIn(500)},success:function(t){e("#price-loading").fadeOut(500),location.href=wp_travel_engine.CheckoutURL}})}))}))},function(e,t){jQuery(document).ready((function(e){e(".trip-price").stick_in_parent()}))},function(e,t){jQuery(document).ready((function(e){e(".wp-travel-engine-datetime").datepicker({maxDate:0,changeMonth:!0,changeYear:!0,dateFormat:"yy-mm-dd",yearRange:"-100:+0"})}))},function(e,t){!function(e,t,a,r){function n(){a(t).find(".trip-review-stars").length&&a(t).find(".trip-review-stars").each((function(){var e=a(this).data("rating-value"),t=""!==(t=a(this).data("icon-type"))?t:"";a(this).rateYo({rating:e,starSvg:t})}))}jQuery(t).ready((function(e){e("body").on("click",".btn-loadmore",(function(t){t.preventDefault();var a=e(this),r=a.attr("data-current-page"),i=a.attr("data-max-page"),o={action:"wpte_ajax_load_more",query:a.attr("data-query-vars"),page:r,nonce:beloadmore.nonce};e.ajax({url:beloadmore.url,data:o,type:"POST",beforeSend:function(t){e("#loader").fadeIn(500)},success:function(e){a.before(e),r++,a.attr("data-current-page",r),r==i&&a.remove()},complete:function(){e("#loader").fadeOut(500),n()}})})),e("body").on("click",".load-destination",(function(t){t.preventDefault();var a=e(this),r=a.attr("data-current-page"),i=a.attr("data-max-page"),o={action:"wpte_ajax_load_more_destination",query:a.attr("data-query-vars"),page:r,nonce:beloadmore.nonce};e.ajax({url:beloadmore.url,data:o,type:"POST",beforeSend:function(t){e("#loader").fadeIn(500)},success:function(e){a.before(e),r++,a.attr("data-current-page",r),r==i&&a.remove()},complete:function(){e("#loader").fadeOut(500),n()}})}))}))}(window,document,jQuery)},function(e,t){function a(e){for(var t=(e+="").split("."),a=t[0],r=t.length>1?"."+t[1]:"",n=/(\d+)(\d{3})/;n.test(a);)a=a.replace(n,"$1"+WPTE_Price_Separator+"$2");return a+r}jQuery((function(e){wte.single_showtabs||(e(".tab-inner-wrapper .tab-anchor-wrapper:first-child").addClass("nav-tab-active"),e(".nb-tab-trigger").click((function(){e(".nb-tab-trigger").removeClass("nav-tab-active"),e(".nb-tab-trigger").parent().parent().removeClass("nav-tab-active"),e(this).addClass("nav-tab-active"),e(this).parent().parent().addClass("nav-tab-active");var t=e(this).data("configuration");e(".nb-configurations").hide(),e(".nb-"+t+"-configurations").show()})),e(".tab_content").hide(),e(".tab_content:first").show(),e("ul.tabs li").click((function(){e(".tab_content").hide();var t=e(this).attr("rel");e("#"+t).fadeIn(),e("ul.tabs li").removeClass("active"),e(this).addClass("active"),e(".tab_drawer_heading").removeClass("d_active"),e(".tab_drawer_heading[rel^='"+t+"']").addClass("d_active")})),e(".tab_drawer_heading").click((function(){e(".tab_content").hide();var t=e(this).attr("rel");e("#"+t).fadeIn(),e(".tab_drawer_heading").removeClass("d_active"),e(this).addClass("d_active"),e("ul.tabs li").removeClass("active"),e("ul.tabs li[rel^='"+t+"']").addClass("active")})),e("ul.tabs li").last().addClass("tab_last")),e((function(){var t=e(".payment-check");!1===t.is(":checked")&&t.is(":visible")&&(t.filter("[value=paypal]").prop("checked",!0),e(".stripe-button").removeClass("active"),e(".stripe-button-el").hide(),e("#wp-travel-engine-order-form").attr("action",WP_OBJ.link.paypal_link))})),e("body").on("click",".paypal-form",(function(t){var a=e(".stripe_checkout_app").attr("src");e(".stripe_checkout_app").attr("src",""),e(".stripe_checkout_app").attr("src",a),e("#wp-travel-engine-order-form").submit()})),e("body").on("click",".payment-check",(function(t){e(this).is(":checked")&&("stripe"==e(this).attr("value")&&(e("#wp-travel-engine-order-form").attr("action",WP_OBJ.link.form_link),e(".paypal-form").hide(),e(".stripe-form").fadeIn("slow"),e(".stripe-button").addClass("active"),e(".stripe-button-el").show()),"paypal"==e(this).attr("value")&&(e("#wp-travel-engine-order-form").attr("action",WP_OBJ.link.paypal_link),e(".stripe-button").removeClass("active"),e(".stripe-button-el").hide(),e(".paypal-form").fadeIn("slow")))})),e("body").on("click",".check-availability",(function(t){t.preventDefault(),e(".date-time-wrapper").fadeIn("slow")})),e("body").on("click",".check-availability",(function(t){t.preventDefault(),e(".wp-travel-engine-price-datetime").focus()})),e("body").on("click",".wp-travel-engine-cart",(function(t){t.preventDefault(),trip_id=e(this).attr("data-id"),nonce=e(this).attr("data-nonce"),jQuery.ajax({type:"post",dataType:"json",url:WTEAjaxData.ajaxurl,data:{action:"wp_add_trip_cart",trip_id:trip_id,nonce:nonce},success:function(t){"already"===t.type?(e(".wp-cart-message-"+trip_id).css("color","orange"),e(".wp-cart-message-"+trip_id).html(t.message).fadeIn("slow").delay(3e3).fadeOut("slow")):"success"===t.type?(e(".wp-cart-message-"+trip_id).css("color","green"),e(".wp-cart-message-"+trip_id).html(t.message).fadeIn("slow").delay(3e3).fadeOut("slow")):(e(".wp-cart-message-"+trip_id).css("color","red"),e(".wp-cart-message-"+trip_id).html(t.message).fadeIn("slow").delay(3e3).fadeOut("slow")),e(".wte-update-cart-button-wrapper:visible").length<1&&e(".wte-update-cart-button-wrapper").css("display","block")}})})),e("#price-loading").fadeOut(2e3),e(".price-holder").fadeIn(2e3),e("body").on("change",".travelers-number",(function(t){$val=e(this).val(),$new_val=e(this).parent().parent().siblings(".trip-price-holder").children(".cart-price-holder").text().replace(/,/g,""),$total=$val*$new_val,$total=a($total),e(this).parent().parent().siblings(".cart-trip-total-price").children(".cart-trip-total-price-holder").text($total),$sum=0,e(".cart-trip-total-price-holder").each((function(t){$tcost=e(this).text().replace(/,/g,""),$sum=parseInt($sum)+parseInt($tcost)})),$sum=a($sum),e(".total-trip-price").text($sum),$value=0,$val1=parseInt(e("span.travelers-number").text()),e("input.travelers-number").each((function(t){""!==e(this).val()&&($value=parseInt($value)+parseInt(e(this).val()))})),$travelers=parseInt($value)+parseInt($val1),e(".total-trip-travelers").text($travelers)})),e("#wp-travel-engine-cart-form").on("submit",(function(t){t.preventDefault();var a=e("#wp-travel-engine-cart-form").serialize(),r=e("#update_cart_action_nonce").val();jQuery.ajax({type:"post",url:WTEAjaxData.ajaxurl,data:{action:"wte_update_cart",nonce:r,data2:a},success:function(){e(".wte-update-cart-msg").text(WPMSG_OBJ.ajax.success),e(".wte-update-cart-msg").css("color","green").fadeIn("slow").delay(3e3).fadeOut("slow")}})})),e("#wte_payment_options").on("change",(function(t){var a=e("#wte_payment_options :selected").val();t.preventDefault(),""!=a&&e("#price-loader").fadeIn("slow").delay("3000").fadeOut("3000")})),e(".accordion-tabs-toggle").next().hasClass("show"),e(".accordion-tabs-toggle").next().removeClass("show"),e(".accordion-tabs-toggle").next().slideUp(350),e(document).on("click",".faq-row .accordion-tabs-toggle",(function(){var t=e(this);t.siblings(".faq-content").toggleClass("show"),t.toggleClass("active"),t.siblings(".faq-content").slideToggle(350),t.find(".dashicons.dashicons-arrow-down.custom-toggle-tabs").toggleClass("open")})),e(document).on("click",".expand-all-faq",(function(t){t.preventDefault(),e(this).children("svg").hasClass("fa-toggle-off")&&e(this).children("svg").toggleClass("fa-toggle-on"),e(this).children("svg").hasClass("fa-toggle-on")&&e(this).children("svg").toggleClass("fa-toggle-off"),e(".faq-row .accordion-tabs-toggle").toggleClass("active"),e(".faq-row").children(".faq-content").toggleClass("show"),e(".faq-row").children(".faq-content").slideToggle(350),e(".faq-row").find(".dashicons.dashicons-arrow-down.custom-toggle-tabs").toggleClass("open")})),e('form[name="wte_enquiry_contact_form"]').submit((function(t){if(t.preventDefault(),e("#wte_enquiry_contact_form").parsley().isValid()){e("#enquiry_submit_button").prop("disabled",!0);var a=jQuery("#redirect-url").val(),r=new FormData(this);e.ajax({dataType:"json",type:"post",processData:!1,contentType:!1,url:WTEAjaxData.ajaxurl,data:r,success:function(t){"success"===t.type?jQuery(".success-msg").html(t.message).fadeIn("slow").delay("3000").fadeOut("3000",(function(){window.location.href=a})):"error"===t.type?(jQuery("#enquiry_email").css("border","1px solid red"),jQuery(".failed-msg").html(t.message).fadeIn("slow").delay("3000").fadeOut("slow",(function(){jQuery("#enquiry_email").css("border","1px solid #d1d1d1"),jQuery("#enquiry_submit_button").prop("disabled",!1)}))):jQuery(".failed-msg").html(t.message).fadeIn("slow").delay("3000").fadeOut("slow",(function(){e("#enquiry_submit_button").prop("disabled",!1)}))}})}})),e("#wp-travel-engine-order-form").submit((function(t){if("Himalayan-Bank"!=e("#wte_payment_options :selected").val()){var a=e(this),r=a.find("input[name=amount]").val();!isNaN(r)&&r.length>0&&(options_val=r,e("<input>").attr({type:"hidden",id:"amount",name:"amount",value:options_val}).appendTo(a))}})),e("#wte_payment_options").on("change",(function(t){var a=e("#wte_payment_options :selected").val();if(t.preventDefault(),""==a||"Test Payment"==a)return e("#wte-checkout-payment-fields").html(""),e("#wp-travel-engine-order-form").attr("action",Url.normalurl),e(".wp-travel-engine-billing-details-wrapper").html(response.data),e(".stripe-button:visible").remove(),e(".stripe-button-el").remove(),e(".wp-travel-engine-submit").show(),void e(".wte-authorize-net-wrap").remove();"PayPal"==a&&jQuery.ajax({type:"post",url:WTEAjaxData.ajaxurl,data:{action:"wte_payment_gateway",val:a,_nonce:WTEAjaxData.nonce},success:function(t){"PayPal"==a&&(e("#wp-travel-engine-order-form").attr("action",Url.paypalurl),e(".wp-travel-engine-billing-details-wrapper").html(t.data),e("#wte-checkout-payment-fields").html(t.data),e(".stripe-button:visible").remove(),e(".stripe-button-el").remove(),e(".wp-travel-engine-submit").show(),e(".wte-authorize-net-wrap").remove()),"Test Payment"==a&&(e("#wp-travel-engine-order-form").attr("action",Url.normalurl),e(".wp-travel-engine-billing-details-wrapper").html(t.data),e(".stripe-button:visible").remove(),e(".stripe-button-el").remove(),e(".wp-travel-engine-submit").show(),e(".wte-authorize-net-wrap").remove())}})})),e("body").on("keyup","#cost_includes",(function(t){e("#include-result").val(e("#cost_includes").val()),e("#include-result").val("<li>"+e("#include-result").val().replace(/\n/g,"</li><li>")+"</li>")})),e("body").on("keyup","#cost_excludes",(function(t){e("#exclude-result").val(e("#cost_excludes").val()),e("#exclude-result").val("<li>"+e("#exclude-result").val().replace(/\n/g,"</li><li>")+"</li>")})),e("body").on("keyup",".itinerary-content",(function(t){e(this).siblings(".itinerary-content-inner").val(e(this).val()),e(this).siblings(".itinerary-content-inner").val("<p>"+e(this).val().replace(/\n/g,"</p><p>")+"</p>")})),e(document).on("click",".expand-all-itinerary",(function(t){t.preventDefault(),e(this).children("i").toggleClass("fa-toggle-on"),e(".itinerary-row").children(".itinerary-content").toggleClass("show"),e(".itinerary-row").children(".itinerary-content").slideToggle(350),e(".itinerary-row").find(".dashicons.dashicons-arrow-down.custom-toggle-tabs").toggleClass("rotator")})),e(document).on("click",".less-no",(function(t){$val=e(this).next("input").val(),0!=$val&&($val=parseInt($val)-1,e(this).next("input").val($val))})),e(document).on("click",".more-no",(function(t){if($val=e(this).prev("input").val(),""==$val)return $val=1,void e(this).prev("input").val($val);$val=parseInt($val)+1,e(this).prev("input").val($val)})),e("#wp-travel-engine-new-checkout-form").parsley(),e("input[name=wp_travel_engine_payment_mode]").length>0&&e(document).on("change","input[name=wp_travel_engine_payment_mode]",(function(){var t=e("input[name=wp_travel_engine_payment_mode]:checked").val(),a=e(".wpte-bf-book-summary .wpte-bf-extra-info-table"),r="partial"==t?wte.payments.total_partial:wte.payments.total;r=wteGetFormatedPriceWithCurrencyCodeSymbol(r),"partial"==t?a.show():a.hide(),e(".wpte-bf-book-summary .wpte-bf-total-price .wpte-price").html(r)})),e("#wte-send-enquiry-message").click((function(e){e.preventDefault(),document.getElementById("wte_enquiry_contact_form").scrollIntoView({behavior:"smooth",block:"center"})})),e("#wte_enquiry_contact_form").parsley(),e(".wte-ordering").on("change","select.orderby",(function(){e(this).closest("form").submit()})),e(window).on("load",(function(){e(window).width()<1025?e(".single-trip .wte_enquiry_contact_form-wrap").insertAfter(".single-trip .widget-area .wpte-bf-outer"):e(".single-trip .widget-area .wte_enquiry_contact_form-wrap").insertAfter(".single-trip .site-main")}));var t=document.querySelectorAll(".wpte-enhanced-select");function r(e,t){null!=e&&null!=t&&e.contentWindow.postMessage(JSON.stringify(t),"*")}function n(e,t){var a,n,i,o,l;if(n=(a=e.find(".slick-current")).attr("class").split(" ")[1],o=a.find("iframe").get(0),i=a.data("video-start"),"vimeo"===n)switch(t){case"play":null!=i&&i>0&&!a.hasClass("started")&&(a.addClass("started"),r(o,{method:"setCurrentTime",value:i})),r(o,{method:"play",value:1});break;case"pause":r(o,{method:"pause",value:1})}else if("youtube"===n)switch(t){case"play":r(o,{event:"command"}),r(o,{event:"command",func:"playVideo"});break;case"pause":r(o,{event:"command",func:"pauseVideo"})}else"video"===n&&null!=(l=a.children("video").get(0))&&("play"===t?l.play():l.pause())}t&&t.forEach((function(t){e(t).select2({closeOnSelect:!1,allowClear:!1})})),e(".wte-trip-vidgal-popup-trigger").on("click",(function(t){t.preventDefault();var a=e(this).data("variable");e.fancybox.open(window[a],{buttons:["zoom","slideShow","fullScreen","close"]})}));var i=e(".main-slider");i.slick&&(i.on("beforeChange",(function(t,a){n(a=e(a.$slider),"pause")})),i.on("afterChange",(function(t,a){n(a=e(a.$slider),"play")})),i.slick({lazyLoad:"progressive",slidesToShow:1,slidesToScroll:1,arrows:!1,dots:!1,fade:!0,asNavFor:".slider-nav",cssEase:"cubic-bezier(0.87, 0.03, 0.41, 0.9)"}),e(".slider-nav").slick({slidesToShow:3,slidesToScroll:1,asNavFor:".main-slider",dots:!1,arrows:!0,focusOnSelect:!0}))})),function(){var e=document.querySelectorAll(".wpte-bf-toggle-wrap");function t(e,t){return function a(r){var n=e.querySelector(".wpte-bf-toggle-content");e.className.indexOf("wpte-bf-active")>-1?function(e,t){var a=1;!function r(){if((a-=.05)<=0)return e.style.removeProperty("opacity"),e.style.display="none",void t();e.style.opacity=a,requestAnimationFrame(r)}()}(n,(function(){document.removeEventListener("click",a),e.classList.remove("wpte-bf-active"),t()})):(e.className.indexOf("wpte-bf-active")<0?e.classList.add("wpte-bf-active"):e.classList.remove("wpte-bf-active"),t())}}e&&e.forEach((function(e){var a=e.querySelector(".wpte-bf-toggle-title"),r=(e.querySelector(".wpte-bf-toggle-content"),e.querySelector(".wpte-bf-toggle-close"));r&&r.addEventListener("click",(function(a){a.preventDefault(),t(e)})),a&&a.addEventListener("click",(function(r){document.addEventListener("click",t(e,(function(){var t=a.querySelector(".wtebf-toggle-title"),r=a.querySelector(".wtebf-toggle-title-active");r&&(r.style.display=e.className.indexOf("wpte-bf-active")>-1?"block":"none"),t&&(t.style.display=e.className.indexOf("wpte-bf-active")<0?"block":"none")})))}))}))}()},function(e,t){jQuery(document).ready((function(e){e("form.wpte-lrf").parsley(),e("a#wpte-show-login-form").click((function(t){t.preventDefault(),e(".wpte-lrf-wrap.wpte-register").slideUp("slow"),e(".wpte-lrf-wrap.wpte-login").slideDown("slow")})),e("a#wpte-show-register-form").click((function(t){t.preventDefault(),e(".wpte-lrf-wrap.wpte-register").slideDown("slow"),e(".wpte-lrf-wrap.wpte-login").slideUp("slow")}))})),jQuery(document).ready((function(e){e(".wpte-dashboard .wpte-lrf-userprogile > a").on("click",(function(t){t.stopPropagation(),e(this).parent(".wpte-lrf-userprogile").toggleClass("active"),e(this).siblings(".lrf-userprofile-popup").stop(!0,!1,!0).slideToggle()})),e(".wpte-dashboard .wpte-lrf-userprogile .lrf-userprofile-popup").on("click",(function(e){e.stopPropagation()})),e("body, html").on("click",(function(){e(".wpte-lrf-userprogile").removeClass("active"),e(".lrf-userprofile-popup").slideUp()})),e(".wpte-dashboard .wpte-lrf-sidebar .wpte-lrf-tab").on("click",(function(){var t=e(this).attr("class").split(" ")[1];e(".wpte-lrf-tab").removeClass("active"),e(this).addClass("active"),e(".wpte-dashboard .wpte-lrf-content-area .wpte-lrf-tab-content").removeClass("active"),e("."+t+"-content").addClass("active")})),e(".lrf-toggle .lrf-toggle-box").on("click",(function(){e(this).toggleClass("active"),e(this).parents(".lrf-toggle").siblings(".wpte-lrf-popup").stop(!0,!1,!0).slideToggle()})),e(window).keyup((function(t){"Escape"==t.key&&(e(".wpte-lrf-userprogile").removeClass("active"),e(".lrf-userprofile-popup").slideUp(),e(this).removeClass("active"),e(".wpte-lrf-popup").slideUp())})),e(".wte-dbrd-tab").click((function(t){t.preventDefault();var a=e(this).data("tab");e(".wpte-lrf-sidebar .wpte-lrf-tab").removeClass("active"),e(".wpte-lrf-sidebar .lrf-"+a).addClass("active"),e(".wpte-lrf-main .wpte-lrf-tab-content").removeClass("active"),e(".wpte-lrf-main .lrf-"+a).addClass("active")})),jQuery(".wpte-magnific-popup").fancybox({type:"inline",baseClass:"wte-fb-popup"})}))},function(e,t){jQuery(document).ready((function(e){function t(e){for(var t=(e+="").split("."),a=t[0],r=t.length>1?"."+t[1]:"",n=/(\d+)(\d{3})/;n.test(a);)a=a.replace(n,"$1"+WPTE_Price_Separator+"$2");return a+r}e("body").on("change",".travelers-no",(function(a){e("#price-loading").fadeIn(500),$val=e(this).val(),$new_val=e(".hidden-price").first().text().replace(/,/g,""),$total=$val*$new_val,e("#trip-cost").val($total),$total=t($total),e(".total").text(t($total)),e("#price-loading").fadeOut(500)}))}))},function(e,t){var a,r;a=document.querySelectorAll(".wpte-checkout-payment-info"),(r=document.querySelectorAll("[name=wpte_checkout_paymnet_method]"))&&r.forEach((function(e){e.checked&&e.parentElement.classList.add("wpte-active-payment-method")&&e.parentElement.querySelector(".wpte-checkout-payment-info").removeAttribute("style"),e.addEventListener("change",(function(e){a&&a.forEach((function(e){e.style.display="none",e.parentElement.classList.remove("wpte-active-payment-method")})),e.target.parentElement.classList.add("wpte-active-payment-method");var t=e.target.parentElement.querySelector(".wpte-checkout-payment-info");t&&t.removeAttribute("style")}))})),new function(e){var t=this;if(e){if(this.applyBtn=e.querySelector(".wp-travel-engine-coupons-apply-btn"),this.resetBtn=e.querySelector(".wte-coupon-response-reset-coupon"),this.tripsField=e.querySelector('input[name="wte_couponse_trip_id"]'),this.dismissButton=e.querySelector(".wte-coupon-remove-trigger"),!this.tripsField)throw new Error("No trips Field.");this.couponCodeField=e.querySelector('input[name="wp_travel_engine_coupon_code_input"]'),this.nonceField=document.getElementById("wte_apply_coupon_nonce"),this.resetNonceField=document.getElementById("wte_reset_coupon_nonce"),this.loader=e.querySelector("#price-loader-coupon"),this.loading=!1,this.summaryTable=document.querySelector(".wpte-bf-summary-table"),this.responseHolder=document.getElementById("coupon-response-holder"),this.dismissButton&&this.dismissButton.addEventListener("click",(function(t){t.preventDefault(),e.remove()})),this.applyBtn&&this.applyBtn.addEventListener("click",function(e){return function(r){r.preventDefault(),a(!0),function(){var e;if(null!==(e=WTEAjaxData)&&void 0!==e&&e.ajaxurl){var a=new FormData;return a.append("action","wte_session_cart_apply_coupon"),a.append("trip_ids",t.tripsField.value),a.append("CouponCode",t.couponCodeField.value),a.append("trip_id",WTEAjaxData.trip_id),a.append("_nonce",t.nonceField.value),setTimeout((function(){return new Promise((function(e,t){return e(!1)}))}),5e3),fetch(WTEAjaxData.ajaxurl,{method:"POST",body:a})}}().then((function(e){return e.json()})).then((function(t){if(t.success)location.reload();else{var r,n=wp.template("wte-coupon-response");wp.template("wte-coupon-response-updated-price"),e.responseHolder&&(r=t.data.reduce((function(e,t){return"".concat(e).concat(t.message)}),""),e.responseHolder.innerHTML=n({type:"error",message:r})),a(!1)}}))}}(this)),this.resetBtn&&this.resetBtn.addEventListener("click",(function(e){e.preventDefault(),a(!0),function(){var e;if(null!==(e=WTEAjaxData)&&void 0!==e&&e.ajaxurl){var a=new FormData;return a.append("action","wte_session_cart_reset_coupon"),a.append("_nonce",t.resetNonceField.value),setTimeout((function(){return new Promise((function(e,t){return e(!1)}))}),5e3),fetch(WTEAjaxData.ajaxurl,{method:"POST",body:a})}}().then((function(e){return e.json()})).then((function(e){if(e.success)window.location.reload();else{var t,r=wp.template("wte-coupon-response");wp.template("wte-coupon-response-updated-price"),couponInstance.responseHolder&&(t=e.data.reduce((function(e,t){return"".concat(e).concat(t.message)}),""),couponInstance.responseHolder.innerHTML=r({type:"error",message:t})),a(!1)}}))}))}function a(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e&&!this.loading&&this.loader&&(this.loader.style.removeProperty("display"),summaryTable&&(summaryTable.style.opacity=".3"),this.loading=!0),!e&&this.loading&&this.loader&&(this.loader.style.display="none",summaryTable&&(summaryTable.style.opacity="1"),this.loading=!1)}}(document.getElementById("wte-checkout-coupon")||null)},function(e,t,a){"use strict";a.r(t);var r=a(4),n=a.n(r),i=a(5),o=a.n(i),l=a(11),s=a.n(l),c=a(12),u=a.n(c);function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function p(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){if(e){if("string"==typeof e)return f(e,void 0);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?f(e,void 0):void 0}}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==a.return||a.return()}finally{if(l)throw i}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}!function(e,t){if(e&&null!=e&&e.l10ns&&t){var a=t.split("_");null==e||e.localize(e.l10ns[a[0]]||e.l10ns.en)}}(window.flatpickr,window.wteL10n.locale),function(e){var t,a,r;if(e){var n=e&&e.querySelector("[type=submit]"),i=(null==n?void 0:n.value)||"Book Now",o=(null==n||null===(t=n.dataset)||void 0===t?void 0:t.checkoutLabel)||"Pay %s",l=(null===(a=e.querySelector("[name=wp_travel_engine_payment_mode]:checked"))||void 0===a?void 0:a.value)||"full_payment",s=(null===(r=e.querySelector("[name=wpte_checkout_paymnet_method]:checked"))||void 0===r?void 0:r.value)||"booking_only";e.addEventListener("change",(function(t){var a,r,c,u,d,p,f,v,m=(null===(a=e.querySelector("[name=wp_travel_engine_payment_mode]:checked"))||void 0===a?void 0:a.value)||"full_payment",g=(null===(r=e.querySelector("[name=wpte_checkout_paymnet_method]:checked"))||void 0===r?void 0:r.value)||"booking_only",w={partial:(null===(c=window)||void 0===c||null===(u=c.wptravelengineCart)||void 0===u||null===(d=u.cart_totals)||void 0===d?void 0:d.cart_total_partial)||0,full_payment:(null===(p=window)||void 0===p||null===(f=p.wptravelengineCart)||void 0===f||null===(v=f.cart_totals)||void 0===v?void 0:v.total)||0,remaining_payment:wte.payments.total-wte.payments.total_partial};if(l!=m||s!=g){if(l=m,s=g,["booking_only","direct_bank_transfer","check_payments"].includes(g))return void(n.value=i);var y=parseFloat(w[m])||0;n&&(n.value=o.replace("%s",wteL10n.priceFormat(y).format(!0)))}}))}}(document.getElementById("wp-travel-engine-new-checkout-form")),function(e){var t=document.querySelectorAll(".wte-search-terms-list");function a(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(a){e.classList.toggle("visible",t)}}if(t)for(var r=0;r<t.length;r++){var i=t[r].querySelector(".wte-terms-more");if(i){var l=i.querySelector(".show-more"),c=i.querySelector(".show-less");l&&l.addEventListener("click",a(i,!0)),c&&c.addEventListener("click",a(i,!1))}}var f=function(e){return function(t,a){var r=e.querySelector("[data-value]"),n=e.querySelector("[data-value-min]"),i=e.querySelector("[data-value-max]"),o=e.querySelector("[data-value-min-display]"),l=e.querySelector("[data-value-max-display]"),s="price"===e.dataset.valueFormat;r&&(r.value=s?wteL10n.priceFormat(a.values[0]).format(!0)+" - "+wteL10n.priceFormat(a.values[1]).format(!0):a.values[0]+" "+(e.dataset.suffix||"")+" - "+a.values[1]+" "+(e.dataset.suffix||"")),n&&(n.value=a.values[0]),i&&(i.value=a.values[1]);var c=e.querySelectorAll(".ui-slider-handle");o&&(o.innerHTML=s?wteL10n.priceFormat(a.values[0]).format(!0):a.values[0]+" "+(e.dataset.suffix||"")),c&&c[0]&&(c[0].dataset.value=s?wteL10n.priceFormat(a.values[0]).format(!0):a.values[0]+" "+(e.dataset.suffix||"")),l&&(l.innerHTML=s?wteL10n.priceFormat(a.values[1]).format(!0):a.values[1]+" "+(e.dataset.suffix||"")),c&&c[1]&&(c[1].dataset.value=s?wteL10n.priceFormat(a.values[1]).format(!0):a.values[1]+" "+(e.dataset.suffix||""))}},v=function(t){var a,r=t.querySelector(t.dataset.rangeSlider);if(r){var n=null===(a=t.dataset.range)||void 0===a?void 0:a.split(",").map((function(e){return+e})),i="price"===t.dataset.valueFormat;window.noUiSlider?(noUiSlider.create(r,{start:n||[0,50],range:{min:[n&&n[0]||0],max:[n&&n[1]||50]},tooltips:[wNumb({decimals:i?2:0,suffix:t.dataset.suffix?" "+t.dataset.suffix:""}),wNumb({decimals:i?2:0,suffix:t.dataset.suffix?" "+(i?wteL10n.baseCurrencySymbol:t.dataset.suffix||""):""})],format:wNumb({decimals:i?2:0}),step:1,connect:!0}),r.noUiSlider.on("update",function(e){return function(t,a){console.debug({values:t});var r=e.querySelector("[data-value]"),n=e.querySelector("[data-value-min]"),i=e.querySelector("[data-value-max]"),o=e.querySelector("[data-value-min-display]"),l=e.querySelector("[data-value-max-display]"),s="price"===e.dataset.valueFormat;r&&(r.value=s?wteL10n.priceFormat(t[0]).format(!0)+" - "+wteL10n.priceFormat(t[1]).format(!0):t[0]+" "+(e.dataset.suffix||"")+" - "+t[1]+" "+(e.dataset.suffix||"")),n&&(n.value=t[0]),i&&(i.value=t[1]);var c=e.querySelectorAll(".ui-slider-handle");o&&(o.innerHTML=s?wteL10n.priceFormat(t[0]).format(!0):t[0]+" "+(e.dataset.suffix||"")),c&&c[0]&&(c[0].dataset.value=s?wteL10n.priceFormat(t[0]).format(!0):t[0]+" "+(e.dataset.suffix||"")),l&&(l.innerHTML=s?wteL10n.priceFormat(t[1]).format(!0):t[1]+" "+(e.dataset.suffix||"")),c&&c[1]&&(c[1].dataset.value=s?wteL10n.priceFormat(t[1]).format(!0):t[1]+" "+(e.dataset.suffix||""))}}(t))):e(r).slider({range:!0,min:n&&n[0]||0,max:n&&n[1]||50,values:n||[0,50],slide:f(t)})}};window.addEventListener("load",(function(e){var t=document.querySelectorAll("[data-range-slider]");if(t)for(var a=0;a<t.length;a++)t[a]&&v(t[a]);!function(e){var t=document.querySelectorAll(e);if(t)for(var a=t.length,r=function(){var e=t[n];if(!e)return"continue";var r=e.querySelector(".wpte__input"),s=e.querySelector(".wpte__input-value");if(r&&(null==r||r.setAttribute("readonly",""),null==r||r.addEventListener("click",(function(r){r.stopPropagation();for(var n=e.classList.contains("options-open"),i=0;i<a;i++)t[i].classList.remove("options-open");e.classList.toggle("options-open",!n)}))),!(i=e.querySelector(".wpte__select-options")))return"continue";o=i.querySelectorAll("li"),l=o.length;for(var c=function(t){var a=t;a.dataset.label&&(r.setAttribute("value",a.dataset.label),s.setAttribute("value",a.dataset.value),function(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];e&&Array.from(e).forEach((function(e){a?e.classList.add(t):e.classList.remove(t)}))}(e.querySelectorAll("li"),"selected",!1),a.classList.add("selected"),a.closest("li").classList.add("selected"),e.classList.remove("options-open"),e.dispatchEvent(new CustomEvent("change",{detail:{value:a.dataset.value,name:s.name}})))},u=0;u<l;u++)""==o[u].dataset.selected&&c(o[u]),o[u].addEventListener("click",(function(e){e.stopPropagation(),c(this)}))},n=0;n<a;n++){var i,o,l;r()}document.addEventListener("click",(function(t){if("wpte__input"!=t.target.className)for(var a=document.querySelectorAll(e),r=a.length,n=0;n<r;n++)a[n].classList.remove("options-open")}))}(".wpte__select-field");var r=document.querySelector(".wte-ordering"),i=r&&r.querySelector(".wpte__select-field")||null;i&&i.addEventListener("change",(function(e){null==r||r.submit()})),new(function(){function e(t){var a,r,n;s()(this,e),this.component=document.querySelector(t),this.component&&(this.resetButton=this.component.querySelector("#reset-trip-search-criteria"),this.resetButton&&this.resetButton.addEventListener("click",this.handleResetClick()),this.initFilters(),this.sortItems(),null!==(a=window)&&void 0!==a&&null!==(r=a.wteL10n)&&void 0!==r&&null!==(n=r.util)&&void 0!==n&&n.on&&window.wteL10n.util.on("click",".load-more-search",this.handleLoadMore()))}return u()(e,[{key:"sortItems",value:function(){var e=document.querySelectorAll(".category-trips-single");if(e){var t,a=(e=Array.from(e)).filter((function(e){return e.classList.contains("__featured-trip")})),r=e.filter((function(e){return!e.classList.contains("__featured-trip")})),n=null===(t=(e=[].concat(o()(a),o()(r)))[0])||void 0===t?void 0:t.parentElement;if(n){n.innerHTML="";var i,l=p(e);try{for(l.s();!(i=l.n()).done;){var s=i.value;n.appendChild(s)}}catch(e){l.e(e)}finally{l.f()}}}}},{key:"handleLoadMore",value:function(){return function(e){var t;e.preventDefault();var a=this,r=a.dataset.currentPage,n=a.dataset.maxPage,i=null===(t=document.querySelector(".wte-view-mode-selection.active"))||void 0===t?void 0:t.dataset.mode,o={action:"wte_show_ajax_result_load",query:a.dataset.queryVars,page:a.dataset.currentPage,mode:i,nonce:a.dataset.nonce},l=new FormData;for(var s in o)l.append(s,o[s]);fetch(WTEAjaxData.ajaxurl,{body:l,method:"POST"}).then((function(e){return e.json()})).then((function(e){var t;e.success&&(jQuery(".wte-category-outer-wrap .category-main-wrap").append((null==e||null===(t=e.data)||void 0===t?void 0:t.data)||""),a.dataset.currentPage=+r+1,a.dataset.currentPage+1>=n&&a.parentElement.remove()),jQuery("#loader").fadeOut(500)}))}}},{key:"fetchfilteredData",value:function(){var e,t,a={action:"wte_show_ajax_result",nonce:this.component.dataset.filterNonce,mode:jQuery(".wte-view-mode-selection.active").attr("data-mode"),sort:null===(e=document.querySelector("[name=wte_orderby]"))||void 0===e?void 0:e.value},r=new FormData,i={},o=this.component.querySelectorAll("input[type=radio]:checked, input[type=checkbox]:checked, .ui-slider"),l=p(o&&Array.from(o)||[]);try{for(l.s();!(t=l.n()).done;){var s=t.value;switch(s.type||s.classList.contains("ui-slider")&&"slider"){case"checkbox":i[s.name]||(i[s.name]=[]),r.append("result[".concat(s.name,"][]"),s.value);break;case"radio":var c="trip-chosen-date"==s.name?"date":s.name;r.append(c,s.value);break;case"number":case"text":s.value="";break;case"slider":var u=jQuery(s).slider("option","values");u&&(s.dataset.minKey&&(a[s.dataset.minKey]=u[0]),s.dataset.maxKey&&(a[s.dataset.maxKey]=u[1]))}}}catch(e){l.e(e)}finally{l.f()}for(var f in a.result=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(Object(a),!0).forEach((function(t){n()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},i),a)"result"!==f&&r.append(f,a[f]);jQuery("#loader").fadeIn(500),fetch(wte_advanced_search.ajax_url,{method:"POST",body:r}).then((function(e){return e.json()})).then((function(e){var t;e.success&&e.data&&(jQuery(".wte-category-outer-wrap").html((null==e||null===(t=e.data)||void 0===t?void 0:t.data)||""),jQuery(".wte-filter-foundposts .searchFoundPosts").html(e.data.foundposts),jQuery(".trip-pagination").remove()),jQuery("#loader").fadeOut(500)}))}},{key:"handleFiltersChange",value:function(e){var t=this;return function(a){t.resetButton.style.removeProperty("display"),"slide"!=e&&t.fetchfilteredData()}}},{key:"initFilters",value:function(){var e=this,t=this.component.querySelectorAll(".advanced-search-field");t=t&&Array.from(t);var a,r=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),n=p(t);try{var i=function(){var e=a.value,t=e.querySelector(".filter-section-title"),n=e.querySelector(".filter-section-content");r?(e.classList.toggle("wte-list-opn",!1),jQuery(n).slideUp(350)):(e.classList.toggle("wte-list-opn",!0),jQuery(n).slideDown(350)),t&&t.addEventListener("click",(function(){e.classList.toggle("wte-list-opn"),n&&jQuery(n).slideToggle()}))};for(n.s();!(a=n.n()).done;)i()}catch(e){n.e(e)}finally{n.f()}["change","slide","slidestop"].forEach((function(t){jQuery(e.component).on(t,e.handleFiltersChange(t))}))}},{key:"handleResetClick",value:function(){var e=this;return function(t){for(var a=e.component.querySelectorAll("input[type=radio], input[type=checkbox], .ui-slider"),r=0,n=Array.from(a);r<n.length;r++){var i=n[r];switch(i.type||i.classList.contains("ui-slider")&&"slider"){case"checkbox":case"radio":i.checked&&(i.checked=!1);break;case"number":case"text":i.value="";break;case"slider":var o=jQuery(i).slider("option");null!=o&&o.max&&(jQuery(i).slider("option","values",[o.min,o.max]),f(i)(null,{values:[o.min,o.max]}))}}this.style.display="none",e.fetchfilteredData()}}}]),e}())("#wte__trip-search-filters")}))}(window.jQuery),jQuery((function(e){var t=document.getElementById("wte-advanced-search-form-shortcode");if(t){var a=t.querySelectorAll('select[name="destination"], .advanced-search-field select[name="cat"], select[name="activities"], .advanced-search-field .trip-date-select');if(a)for(var r=0;r<a.length;r++)jQuery(a[r]).niceSelect()}}))},function(e,t,a){"use strict";a.r(t)},function(e,t,a){"use strict";a.r(t)},function(e,t,a){"use strict";a.r(t)},function(e,t,a){"use strict";a.r(t)},function(e,t,a){"use strict";a.r(t)}]);